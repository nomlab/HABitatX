<%= form_with(model: item, html: { class: "styled-form" }) do |form| %>
  <% if item.errors.any? %>
    <div class="error-box">
      <h2>エラーが発生しました (<%= pluralize(item.errors.count, "error") %>):</h2>
      <ul>
        <% item.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= form.label :name, "アイテム名", class: "form-label" %>
    <%= form.text_field :name, class: "form-input", placeholder: "アイテムの名前を入力してください" %>
  </div>

  <div class="form-group">
    <%= form.label :dsl_info, 'スプレッドシート', class: "form-label" %>
    <%= form.file_field :dsl_info, accept: '.xls, .xlsx', class: "form-input" %>
    <small style="color: var(--text-muted); display: block; margin-top: 4px;">
      Excel形式のファイル（.xls, .xlsx）をアップロードしてください
    </small>
  </div>

  <% template_options = @template.present? ? @template.map { |template| [template.name, template.name] } : [] %>
  <div class="form-group">
    <%= form.label :title_template, 'テンプレート', class: "form-label" %>
    <%= form.select :title_template, 
        options_for_select([['テンプレートを選択してください', '']] + template_options), 
        {}, 
        { class: "form-select" } %>
  </div>

  <div class="form-actions">
    <%= form.submit item.persisted? ? "Update Item" : "Create Item", class: "button large success" %>
    <%= link_to "戻る", items_path, class: "button secondary" %>
  </div>
<% end %>
